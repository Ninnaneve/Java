# SELECT 子句
## 指定字段查询
相当于关系代数中的投影运算。
- 列出特定字段名对应数据（即进行字段的筛选）。
``` mysql
SELECT 字段名1, 字段名2, ..., 字段名n
FROM 表名;
```
- 如果需要查询表中的所有字段，则可采用*匹配符替代。
``` mysql
SELECT *
FROM 表名;
```
- 当不需要显示所有查询结果时，可以通过LIMIT限定查询的行数。
> 参数m为偏移量，n为返回的个数
``` mysql
SELECT *|{字段名1,字段名2,……}
FROM 表名
LIMIT m [,n];
```
> 注意: 查询结果字段排序为DESC 表名中的字段排序。



# WHERE子句

相当于关系代数中的选择运算。
## 带关系运算符的查询
``` mysql
SELECT *|字段名1,字段名2,……
FROM 表名
WHERE 条件表达式
LIMIT [m,] n;
```
- 数值的大小比较

常见的关系运算符号：=、<>、!=、<、<=、>、>=
> 注意：
在SQL中，a <= x <= b并不等价于 x >= a and x <= b。
例如，100 <= price <= 500先运算100 <= price，再将运算结果(true或false)与500进行比较，显然对于每一行有price值且大于等于0的行都成立.

- 字符串与数值的大小比较
  理论上而言，字符串类型值小于所有的数值。
  然而，需要注意SQL中的比较运算会自动转换类型：
    - 如果比较运算符左右为数值和**能转换为数值的字符串**（包括字符串前几位为数字，后几位为字符的情形），则现先将字符串转为数值后比较数值大小
    - 如果比较运算符左右为数值和**不能转换为数值的字符串**，则数值方大于字符串方
    - 如果比较运算符左右两方**都为字符串形式数值**，则按字符序比较规则决定大小

## 带IN关键字的查询: 限定值的可选集
``` mysql
SELECT *|字段名1,字段名2,……
FROM 表名
WHERE 字段名 [NOT] IN (元素1,元素2,……);
```
例如，查找product表中产地不为'天津'，'北京', '日本'的商品的全部记录
``` mysql
select *
from product
where product_place not in ('天津', '北京', '日本');
```
- IN后的可选择集合可为子查询SELECT的结果集
例如，查找product表sort_id属于sort表中sort_id的行
``` mysql
select *
from product 
where sort_id in (select sort_id from sort);
```
## 带BETWEEN ... AND...关键字的查询：限定值的范围
仅限于数值。
``` mysql
SELECT *|字段名1,字段名2,……
FROM 表名 
WHERE 字段名 [NOT] BETWEEN 值1 AND 值2;
```
## NULL判断：查询某些列值是否为空
``` mysql
SELECT *|字段名1,字段名2,……
FROM 表名
WHERE 字段名 IS [NOT] NULL;
```
##  字段前带DISTINCT关键字的查询：剔除查询结果中的重复行
``` mysql
SELECT DISTINCT 字段名
FROM 表名
[WHERE 条件表达式];
```
DISTINCT关键字作用于**多个字段**：只有DISTINCT关键字后指定的所有字段值都相同，才会被认作是重复记录。
例如，找出product表中不同的根类别和子类别的组合
``` mysql
select distinct sort_id, subsort_id
from product;
```


# 匹配字符串

## 带LIKE关键字的字符串简单匹配
``` mysql
SELECT *|{字段名1,字段名2,……}
FROM 表名
WHERE 字段名 [NOT] LIKE '匹配字符串';
```
LIKE语法格式中的“匹配字符串”指定用来匹配的字符串，其值可以是一个普通字符串，也可以是包含百分号(%)和下划线(_)等通配字符串: 
- %: 可以匹配**任意长度的任意字符串**，包括**空字符**
- _: 下划线通配符**只匹配1个任意字符**，如果要匹配多个任意字符，需要使用多个下划线通配符
> 如果要匹配字符串中的百分号和下划线，就需要在通配字符串中使用右斜线(\\)对百分号和下划线进行转义。

例如，查找product表中商品名称含有复印机的商品的product_name, price，product_place
``` mysql
select product_name, product_place, price
from product
where product_name like '%复印机%';
```

## 利用正则表达式匹配字符串: regexp或rlike
> 不太熟练，暂时不建议用

[![OLpq0g.jpg](https://s1.ax1x.com/2022/05/20/OLpq0g.jpg)](https://imgtu.com/i/OLpq0g)

例如，查找product表中product_name末尾字符串为'复印机'的product_name, price, product_place
``` mysql
select product_name, product_place, price
from product
where product_name regexp '复印机$';
```



# 复合查询

## 带AND关键字的多条件查询: 连接两个或者多个查询条件
``` mysql
SELECT *|{字段名1,字段名2,……}
FROM 表名
WHERE 条件表达式1 […… AND 条件表达式n];
```

## 带OR关键字的多条件查询: 匹配其中的一个条件
``` mysql
SELECT *|{字段名1,字段名2,……}
FROM 表名
WHERE 条件表达式1 […… OR 条件表达式n];
```
例如，找出product表商品名称含有_或%的记录
> 多重判定条件的条件一定要写完整。

``` mysql
select *
from product 
where product_name like '%\%%' or product_name like '%\_%';
-- 或者
select *
from product
where product_name regexp '%|_';
```
> OR和AND关键字一起使用的情况: AND的优先级高于OR。当两者在一起使用时，应该先运算AND两边的条件表达式，再运算OR两边的条件表达式。



# Exercise

在product表中完成以下查询：
- 找出零售价在500元到1000元的商品记录，显示Product_ID, Product_Name, Price, Product_Place, SubSort_ID和Sort_ID。
``` mysql
select product_id, product_name, price, product_place, subsort_id, sort_id
from product
where price between 500 and 1000;
```
- 找出product_name中含有'理光'和'墨粉'的商品记录。
``` mysql
select * 
from product
where product_name like '%理光%墨粉%' or product_name like '%墨粉%理光%';
```
- 找出product_place不为空且product_name包含'计算'的商品记录，显示前10条记录。
``` mysql
select * 
from product
where product_place is not null and product_name like '%计算%'
limit 10;
```
- 找出Product_place的不同值。
``` mysql
select distinct product_place
from product;
```
- 找出价格在1000元以下的书柜和价格在1000元到2000元之间的保险柜商品记录。
``` mysql
select *
from product
where (product_name like '%书柜%' and price <1000) or (product_name like '%保险柜%' and price between 1000 and 2000);
```



# P.S. MySQL数据的写入写出

> 考的可能性不大

## 将查询结论写入外部文件
> 找到ProgramData中的my.ini文件（例如：'C:\ProgramData\MySQL\MySQL Server 5.7\my.ini' ）, 将其中的变量secure-file-priv的值设置为空(secure-file-priv=""), 设置好之后重启mysql服务，即可将数据存储到任意文件夹下或从任意文件夹中导入数据。

``` mysql
SELECT 字段1, 字段2, ... | *
FROM 表名 
WHERE 条件表达式
INTO OUTFILE "文件路径+文件名+扩展名" CHARACTER SET 字符集
FIELDS TERMINATED BY 字段值分割符 
OPTIONALLY ENCLOSED BY 字符串标识符 
LINES TERMINATED BY 换行符;
```
例如，将product表的查询结果导出到文件
``` mysql
select *
from product
into outfile 'e:/product.csv' character set gbk
fields terminated by ','
optionally enclosed by '"'
lines terminated by '\n';
```
## 将外部文件数据导入到MySQL中
> 准备工作：csv文本文件，例如e:/1.csv

``` mysql
LOAD DATA INFILE "文件路径+文件名+扩展名"
INTO TABLE 表名 CHARACTER SET 字符集
FIELDS TERMINATED BY 字段值分割符
OPTIONALLY ENCLOSED BY 字符串标识符
LINES TERMINATED BY 换行符;
```
例如，写入上述数据文件至Mysql
``` mysql
load data infile 'e:/product.csv'
into table product character set gbk
fields terminated ny ','
optinally enclosed by '"'
lines terminated by '\n';
```
